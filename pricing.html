<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Step 3 - Product & Pricing Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
          url("https://cdn.pixabay.com/photo/2017/06/21/20/33/background-2428463_1280.jpg")
            center/cover no-repeat fixed;
        color: #fff;
      }

      .step-container {
        display: flex;
        flex-wrap: wrap;
        padding: 30px;
        gap: 30px;
        justify-content: center;
      }

      .form-side {
        flex: 1;
        max-width: 800px;
        padding: 30px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        color: #fff;
        display: flex;
        flex-direction: column;
        gap: 20px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      }

      .preview-side {
        flex-grow: 1;
        max-width: 500px;
        padding: 30px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(12px);
        border-radius: 16px;
        overflow-y: auto;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        color: #fff;
      }

      h2 {
        font-weight: 700;
        font-size: 1.6rem;
        margin-bottom: 20px;
        color: #fea500ff;
      }

      .form-control,
      .form-check {
        margin-bottom: 20px;
      }

      .section-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin-top: 30px;
        margin-bottom: 10px;
        color: #ffe259;
      }

      .btn-group {
        display: flex;
        gap: 12px;
        margin-top: 30px;
      }

      .product-card {
        flex: 1 1 250px;
        background: linear-gradient(to right, #ffffff, #f1f1f1);
        padding: 20px;
        border: none;
        width: 100%;
        max-width: 500px;
        border-radius: 12px;
        text-align: left;
        color: #333;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
      }

      .product-card img {
        max-width: 100%;
        height: auto;
        border-radius: 12px;
        margin-bottom: 10px;
      }

      #editor {
        width: 100%;
        max-width: 100%;
        overflow: hidden;
        border-radius: 10px;
        background-color: #ffffff;
        border: 1px solid #ccc;
        padding: 10px;
        box-sizing: border-box;
        color: #000;
      }

      .ql-container {
        border: none;
      }

      @media (max-width: 768px) {
        .step-container {
          flex-direction: column;
          align-items: center;
        }

        .form-side,
        .preview-side {
          max-width: 100%;
        }
      }
      .ql-toolbar {
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid #ffffff;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container text-center mt-4"></div>

    <div class="step-container">
      <!-- Form Side -->
      <div class="form-side">
        <h2>Let's Add our first product</h2>

        <div class="section-title">Basic Details</div>
        <input
          type="text"
          id="title"
          class="form-control"
          placeholder="eg: anatomy book"
        />

        <label class="form-label">Product Description</label>
        <div id="editor" style="height: 200px"></div>

        <label class="form-label">Add Image(s)</label>
        <input type="file" id="images" class="form-control" multiple />

        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="skuCheck" />
          <label class="form-check-label" for="skuCheck"
            >This product has an SKU code</label
          >
        </div>
        <input
          type="text"
          id="sku"
          class="form-control"
          placeholder="eg: PRODUCT01"
        />

        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="hsnCheck" />
          <label class="form-check-label" for="hsnCheck"
            >This product has an HSN/SAC code</label
          >
        </div>
        <input
          type="text"
          id="hsn"
          class="form-control"
          placeholder="eg: 4901"
        />

        <div class="section-title">Pricing Details</div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="gstIncluded" />
          <label class="form-check-label" for="gstIncluded"
            >Price inclusive of GST</label
          >
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="netPrice"
              class="form-control"
              placeholder="Net price (eg: 80)"
            />
          </div>
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="listPrice"
              class="form-control"
              placeholder="List price (eg: 100)"
            />
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="discount"
              class="form-control"
              placeholder="Discount percentage (eg: 20)"
            />
          </div>
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="gst"
              class="form-control"
              placeholder="GST rate (eg: 12)"
            />
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="shipping"
              class="form-control"
              placeholder="Shipping charges (eg: 40)"
            />
          </div>
          <div class="col-md-6 mb-3">
            <input
              type="text"
              id="stock"
              class="form-control"
              placeholder="Stock level (eg: 110)"
            />
          </div>
        </div>

        <div class="btn-group">
          <button
            onclick="window.location.href='step.html'"
            class="btn btn-secondary"
          >
            Back
          </button>

          <button class="btn btn-success" onclick="addProduct()">
            Add Product
          </button>
          <button
            onclick="window.location.href='last.html'"
            class="btn btn-primary"
          >
            Next
          </button>
        </div>
      </div>

      <!-- Preview Side -->
      <div class="preview-side" id="previewSide">
        <!-- Product cards will appear here -->
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script>
      const quill = new Quill("#editor", {
        theme: "snow",
        placeholder: "Write your product description here...",
        modules: {
          toolbar: [
            [{ font: [] }, { size: [] }],
            ["bold", "italic", "underline", "strike"],
            [{ align: [] }],
            [{ color: [] }, { background: [] }],
            [{ list: "ordered" }, { list: "bullet" }],
            ["clean"],
          ],
        },
      });

      let products = [];
      let editIndex = -1;

      function addProduct() {
        const title = $("#title").val().trim();
        const desc = quill.root.innerHTML.trim();
        const sku = $("#sku").val().trim();
        const hsn = $("#hsn").val().trim();
        const netPrice = $("#netPrice").val().trim();
        const listPrice = $("#listPrice").val().trim();
        const discount = $("#discount").val().trim();
        const gst = $("#gst").val().trim();
        const shipping = $("#shipping").val().trim();
        const stock = $("#stock").val().trim();
        const gstIncluded = $("#gstIncluded").prop("checked");
        const files = $("#images")[0].files;
        let imageURLs = [];

        if (editIndex === -1 && files.length === 0) {
          alert("Please add at least one image.");
          return;
        }

        if (files.length > 0) {
          $.each(files, function (_, file) {
            const url = URL.createObjectURL(file);
            imageURLs.push(url);
          });
        } else if (editIndex !== -1) {
          imageURLs = products[editIndex].images;
        }

        const product = {
          title,
          desc,
          sku,
          hsn,
          netPrice,
          listPrice,
          discount,
          gst,
          shipping,
          stock,
          gstIncluded,
          images: imageURLs,
        };

        if (editIndex !== -1) {
          products[editIndex] = product;
          editIndex = -1;
        } else {
          products.push(product);
        }

        updatePreview();
        clearForm();
        localStorage.setItem("products", JSON.stringify(products));
      }

      function updatePreview() {
        const container = $("#previewSide");
        container.html("");
        $.each(products, function (i, p) {
          const html = `
      <div class="product-card">
        <img src="${p.images[0]}" alt="Product Image" />
        <h6 class="mt-2" style="color: #007bff; font-weight: bold;">${
          p.title
        }</h6>
        <div style="font-size: 14px;">${p.desc}</div>
        ${p.hsn ? `<small>HSN: ${p.hsn}</small><br>` : ""}
        ${p.netPrice ? `<strong>Net Price:</strong> ₹${p.netPrice}<br>` : ""}
        ${p.listPrice ? `<strong>List Price:</strong> ₹${p.listPrice}<br>` : ""}
        ${p.discount ? `<strong>Discount:</strong> ${p.discount}%<br>` : ""}
        ${
          p.gstIncluded
            ? `<small><em>GST is included in the price</em></small><br>`
            : ""
        }
        ${
          p.shipping
            ? `<strong>Shipping Charges:</strong> ₹${p.shipping}<br>`
            : ""
        }
        ${p.stock ? `<strong>Stock Level:</strong> ${p.stock}<br>` : ""}
        <div class="mt-2">
          <button class="btn btn-sm btn-warning me-2" onclick="editProduct(${i})">Edit</button>
          <button class="btn btn-sm btn-danger" onclick="deleteProduct(${i})">Delete</button>
        </div>
      </div>`;
          container.append(html);
        });
      }

      function clearForm() {
        $(".form-control").val("");
        $(".form-check-input").prop("checked", false);
        quill.setContents([]);
      }

      function editProduct(index) {
        const p = products[index];
        $("#title").val(p.title);
        quill.root.innerHTML = p.desc;
        $("#sku").val(p.sku);
        $("#hsn").val(p.hsn);
        $("#netPrice").val(p.netPrice);
        $("#listPrice").val(p.listPrice);
        $("#discount").val(p.discount);
        $("#gst").val(p.gst);
        $("#shipping").val(p.shipping);
        $("#stock").val(p.stock);
        $("#gstIncluded").prop("checked", p.gstIncluded);
        editIndex = index;
        $("html, body").animate({ scrollTop: 0 }, "smooth");
      }

      function deleteProduct(index) {
        if (confirm("Are you sure you want to delete this product?")) {
          products.splice(index, 1);
          localStorage.setItem("products", JSON.stringify(products));
          updatePreview();
        }
      }

      $(document).ready(function () {
        const saved = localStorage.getItem("products");
        if (saved) {
          products = JSON.parse(saved);
          updatePreview();
        }
      });
    </script>
  </body>
</html>
